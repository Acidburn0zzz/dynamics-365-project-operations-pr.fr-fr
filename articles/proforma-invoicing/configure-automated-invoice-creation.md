---
title: Configurer une création de facture automatisée
description: Cette rubrique fournit des informations sur la façon de configurer le système pour générer automatiquement des factures.
author: rumant
manager: Annbe
ms.date: 10/13/2020
ms.topic: article
ms.service: project-operations
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 0dddd963e79f8ecd91a96a6e684ab79e1b95bd6d
ms.sourcegitcommit: fa32b1893286f20271fa4ec4be8fc68bd135f53c
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/15/2021
ms.locfileid: "5287910"
---
# <a name="configure-automatic-invoice-creation"></a><span data-ttu-id="0a02e-103">Configurer une création de facture automatisée</span><span class="sxs-lookup"><span data-stu-id="0a02e-103">Configure automatic invoice creation</span></span>

<span data-ttu-id="0a02e-104">_**S’applique à :** Project Operations pour les scénarios selon les ressources/produits non stockés_</span><span class="sxs-lookup"><span data-stu-id="0a02e-104">_**Applies To:** Project Operations for resource/non-stocked based scenarios_</span></span>


<span data-ttu-id="0a02e-105">Effectuez les étapes suivantes pour configurer une exécution de facture automatisée dans Dynamics 365 Project operations.</span><span class="sxs-lookup"><span data-stu-id="0a02e-105">Complete the following steps to configure an automated invoice run in Dynamics 365 Project operations.</span></span>

1. <span data-ttu-id="0a02e-106">Accédez à **Paramètres** > **Traitements par lots**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-106">Go to **Settings** > **Batch jobs**.</span></span>
2. <span data-ttu-id="0a02e-107">Créez un traitement par lots, et nommez-le **Créer des factures dans Project Operations**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-107">Create a batch job, and name it **Project operations create invoices**.</span></span> <span data-ttu-id="0a02e-108">Le nom du traitement par lots doit inclure les mots « Créer des factures ».</span><span class="sxs-lookup"><span data-stu-id="0a02e-108">The name of the batch job must include the words "create invoices."</span></span>
3. <span data-ttu-id="0a02e-109">Dans le champ **Type de tâche**, sélectionnez **Aucun**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-109">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="0a02e-110">Par défaut, les options **Fréquence quotidienne** et **Est actif** sont définies sur **Oui**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-110">By default, the **Frequency Daily** and **Is Active** options are set to **Yes**.</span></span>
4. <span data-ttu-id="0a02e-111">Sélectionnez **Exécuter le flux de travail**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-111">Select **Run Workflow**.</span></span> <span data-ttu-id="0a02e-112">Dans la boîte de dialogue **Rechercher un enregistrement**, vous verrez trois workflows :</span><span class="sxs-lookup"><span data-stu-id="0a02e-112">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

    - <span data-ttu-id="0a02e-113">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="0a02e-113">ProcessRunCaller</span></span>
    - <span data-ttu-id="0a02e-114">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="0a02e-114">ProcessRunner</span></span>
    - <span data-ttu-id="0a02e-115">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="0a02e-115">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="0a02e-116">Sélectionnez **ProcessRunCaller**, puis **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-116">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="0a02e-117">Dans la boîte de dialogue suivante, sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-117">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="0a02e-118">Un workflow **Veille** est suivi d’un workflow **Processus**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-118">A **Sleep** workflow is followed by a **Process** workflow.</span></span>

  > [!NOTE]
  > <span data-ttu-id="0a02e-119">Vous pouvez également sélectionner **ProcessRunner** à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="0a02e-119">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="0a02e-120">Ensuite, lorsque vous sélectionnez **OK**, un workflow **Processus** est suivi d’un workflow **Veille**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-120">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="0a02e-121">Les workflows **ProcessRunCaller** et **ProcessRunner** créent des factures.</span><span class="sxs-lookup"><span data-stu-id="0a02e-121">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="0a02e-122">**ProcessRunCaller** appelle **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="0a02e-122">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="0a02e-123">**ProcessRunner** est le workflow qui crée en fait les factures.</span><span class="sxs-lookup"><span data-stu-id="0a02e-123">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="0a02e-124">Il traverse toutes les lignes de contrat pour lesquelles des factures doivent être créées, et crée des factures pour ces lignes.</span><span class="sxs-lookup"><span data-stu-id="0a02e-124">It goes through all the contract lines that invoices must be created for, and it creates invoices for those lines.</span></span> <span data-ttu-id="0a02e-125">Pour déterminer les lignes de contrat pour lesquelles des factures doivent être créées, la tâche recherche les dates d’exécution de factures des lignes de contrat.</span><span class="sxs-lookup"><span data-stu-id="0a02e-125">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="0a02e-126">Si des lignes de contrat qui appartiennent à un contrat disposent de la même date d’exécution de factures, les transactions sont combinées en une seule facture avec deux lignes de facture.</span><span class="sxs-lookup"><span data-stu-id="0a02e-126">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="0a02e-127">S’il n’existe pas de transaction pour créer des factures, la tâche ignore la création de facture.</span><span class="sxs-lookup"><span data-stu-id="0a02e-127">If there are no transactions to create invoices for, the job skips invoice creation.</span></span>

<span data-ttu-id="0a02e-128">Une fois que **ProcessRunner** a fini de s’exécuter, il appelle **ProcessRunCaller**, fournit l’heure de fin, et est fermé.</span><span class="sxs-lookup"><span data-stu-id="0a02e-128">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="0a02e-129">**ProcessRunCaller** lance alors une minuterie qui s’exécute pendant 24 heures à partir de l’heure de fin spécifiée.</span><span class="sxs-lookup"><span data-stu-id="0a02e-129">**ProcessRunCaller** then starts a timer that runs for 24 hours from the specified end time.</span></span> <span data-ttu-id="0a02e-130">À la fin de la minuterie, **ProcessRunCaller** est fermé.</span><span class="sxs-lookup"><span data-stu-id="0a02e-130">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="0a02e-131">La tâche de traitement par lots pour la création de factures est une tâche périodique.</span><span class="sxs-lookup"><span data-stu-id="0a02e-131">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="0a02e-132">Si ce traitement par lots est exécuté de nombreuses fois, plusieurs instances de la tâche sont créées et entraînent des erreurs.</span><span class="sxs-lookup"><span data-stu-id="0a02e-132">If this batch process is run many times, multiple instances of the job are created and cause errors.</span></span> <span data-ttu-id="0a02e-133">Par conséquent, vous devez démarrer le traitement par lots une seule fois, et vous devez le redémarrer uniquement s’il cesse de s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="0a02e-133">Therefore, you should start the batch process only one time, and you should restart it only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="0a02e-134">La facturation par lots ne s’exécute que pour les lignes de contrat de projet qui sont configurées par des calendriers de facturation.</span><span class="sxs-lookup"><span data-stu-id="0a02e-134">Batch invoicing only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="0a02e-135">Une ligne de contrat avec une méthode de facturation à prix fixe doit avoir des jalons configurés.</span><span class="sxs-lookup"><span data-stu-id="0a02e-135">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="0a02e-136">Une ligne de contrat de projet avec une méthode de facturation en régie nécessite la configuration d’un calendrier de facturation basé sur la date.</span><span class="sxs-lookup"><span data-stu-id="0a02e-136">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span> <span data-ttu-id="0a02e-137">Il en va de même pour une ligne de contrat basée sur un projet.</span><span class="sxs-lookup"><span data-stu-id="0a02e-137">The same applies to a project-based contract line.</span></span>     


[!INCLUDE[footer-include](../includes/footer-banner.md)]